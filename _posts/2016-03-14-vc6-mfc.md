---
layout: post
title: VC6.0下的MFC——创建一个简单的程序
date: 2016-03-14 00:00:00
categories: Code
excerpt : VC6.0下的MFC——创建一个简单的程序
---

* content
{:toc}

## 概述

刚好有人要学习这个东西，回忆整理一下，本人环境Win7_x64。

## 创建一个MFC工程

[VC6.0下载地址分享](https://yunpan.cn/cmEkrB8j9GAvZ)（访问密码:8e1f）

部分图片来源：[VC++6.0 MFC基于对话框简单计算器设计](http://wenku.baidu.com/link?url=KKVn1lLW6Lw79BMHGfB5pLhAaQDMpQxpLldryA6OolPwWzSTXLsTyZ1Z4QoapbOXlzFGHAWLJKEy6VJ37UPIBpbkPxnz88KuFCdTCSVKc6a)

一个简单的a+b程序创建步骤：

- ![001](/assets/blog-images/2016-03/001.png)
- ![002](/assets/blog-images/2016-03/002.png)
- ![003](/assets/blog-images/2016-03/003.png)
- 在“控件”面板拉需要的控件到对话框

	![004](/assets/blog-images/2016-03/004.png)
		
	“控件”面板的打开，选择打开一个Dialog，在工具栏，右键点击空白处，选择“控件”。
	
	选择已经放好的控件，右键可以查看和修改属性
- 为输入框绑定变量
	
	Ctrl+W打开“MFC ClassWizard”，选择“Member Variables”，为需要的控件绑定变量。
	
	![005](/assets/blog-images/2016-03/005.png)
	
- 双击输入框和按钮，添加函数。

	输入框函数中写`UpdateData(TRUE);`
	
	Cal按钮函数中写
	
		m_num3 = m_num1 + m_num2;
		UpdateData(FALSE);
	
	Help按钮函数写`MessageBox.Show("Help")`
	
- 编译运行

## 遇到的问题

### MSVCRTD.dll丢失

运行报错![006](/assets/blog-images/2016-03/006.png)

一开始找到这个[让 Windows7 - 64bit 支持 VC++ 6.0 的解决方法（无法启动此程序，因为计算机中丢失 MSVCRTD.dll。尝试重新安装该程序以解决此问题）](http://www.cnblogs.com/poissonnotes/p/4372136.html)

无效

然后这个[无法启动此程序，因为计算机中丢失MSVCRTD.dll。尝试重新安装该程序已解决此问题](http://zhidao.baidu.com/link?url=6ziv_P5lDdLp5Egs6AiTvYCe8DdzcowuAZmWEIOmBIDA-4byQg5p-zWDGMlsTBiG9gv5CzG_M6hU9UMaWEU0Na)

报错![007](/assets/blog-images/2016-03/007.png)

猜测可能之前下载的版本不对，重新找了一个，放到Windows目录就好了，参考[win 7 64位 MSVCRTD.DLL 丢失](http://zhidao.baidu.com/link?url=oNC6G7DG1wonzkus5ruu2di67o6o4ngo7Pr37K-mz1caSLOWq7wRZfR6rcxSMFRJZPHncg5bP_8AtkR5fha4Sq)。

> 备注：MSVCRTD.dll也可在上面的下载分享中下载。

### VC6执行“文件->打开”即闪退

可以找到上次报错的工作，把xx.dsw文件拖到VC6上，可以正常打开运行。
